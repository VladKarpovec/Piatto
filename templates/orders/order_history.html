{% extends "base.html" %}
{% block title %}–Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–º–æ–≤–ª–µ–Ω—å{% endblock %}

{% block content %}
<div class="container my-5">
  <div class="text-center mb-5">
    <h2 class="fw-bold text-dark mb-2">üçΩÔ∏è –ú–æ—ó –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h2>
    <p class="text-muted">–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —ñ—Å—Ç–æ—Ä—ñ—é –≤–∞—à–∏—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å —É Piatto</p>
  </div>

  {% if orders %}
  <div class="table-responsive shadow rounded-4 overflow-hidden">
    <table class="table align-middle text-center mb-0 bg-white">
      <thead class="bg-light text-uppercase text-secondary small">
        <tr>
          <th class="py-3">‚Ññ</th>
          <th>–î–∞—Ç–∞</th>
          <th>–°—Ç–∞—Ç—É—Å</th>
          <th>–°—É–º–∞</th>
          <th>–°—Ç—Ä–∞–≤–∏</th>
          <th>–î—ñ—ó</th>
        </tr>
      </thead>
      <tbody>
        {% for order in orders %}
        <tr class="order-row">
          <td class="fw-semibold text-dark">{{ order.id }}</td>
          <td>{{ order.created_at|date:"d.m.Y H:i" }}</td>
          <td>
            {% if order.is_confirmed %}
              <span class="badge rounded-pill bg-success px-3 py-2 shadow-sm">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ</span>
            {% else %}
              <span class="badge rounded-pill bg-warning text-dark px-3 py-2 shadow-sm">–û—á—ñ–∫—É—î</span>
            {% endif %}
          </td>
          <td class="fw-bold text-success">{{ order.total_price }} –≥—Ä–Ω</td>
          <td>
            <ul class="list-unstyled small mb-0 text-start">
              {% for item in order.items.all %}
                <li>‚Ä¢ {{ item.dish.name }} <span class="text-muted">(x{{ item.quantity }})</span></li>
              {% endfor %}
            </ul>
          </td>
          <td>
            <form method="post" action="{% url 'orders:repeat_order' order.id %}" class="d-inline">
              {% csrf_token %}
              <button type="submit" class="btn btn-sm btn-outline-primary rounded-pill px-3">
                üîÅ –ü–æ–≤—Ç–æ—Ä–∏—Ç–∏
              </button>
            </form>

            {% if not order.is_confirmed %}
            <form method="post" action="{% url 'orders:cancel_order' order.id %}" class="d-inline" onsubmit="return confirm('–í–∏ —Ç–æ—á–Ω–æ —Ö–æ—á–µ—Ç–µ –≤—ñ–¥–º–æ–≤–∏—Ç–∏—Å—å –≤—ñ–¥ —Ü—å–æ–≥–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?')">
              {% csrf_token %}
              <button type="submit" class="btn btn-sm btn-outline-danger rounded-pill px-3">
                ‚ùå –í—ñ–¥–º–æ–≤–∏—Ç–∏—Å—å
              </button>
            </form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <div class="text-center py-5">
    <h5 class="text-muted mb-3">–£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î –∑–∞–º–æ–≤–ª–µ–Ω—å üçï</h5>
    <a href="{% url 'menu:menu' %}" class="btn btn-lg btn-primary rounded-pill shadow-sm">
      –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –º–µ–Ω—é
    </a>
  </div>
  {% endif %}
</div>
{% endblock %}

{% block extra_css %}
<style>
  .section-title { font-size: 2rem; font-weight: 600; }
  .table { border-radius: 0.75rem; overflow: hidden; }
  .table tbody tr:hover {
    background-color: #f8f9fa;
    transition: 0.2s ease-in-out;
  }
  .order-row td {
    vertical-align: middle;
  }
  .btn-sm {
    transition: all 0.2s ease-in-out;
  }
  .btn-sm:hover {
    transform: scale(1.05);
  }
</style>
{% endblock %}
